{% extends 'base.html.twig' %}

{% block title %}Mes cours â€” Knowledge Learning{% endblock %}

{% block body %}
<section class="user-courses">
    <h1>ğŸ“š Mes achats</h1>

    {# RÃ©cupÃ¨re la liste des cursus achetÃ©s #}
    {% set purchasedCursusIds = purchases
        |filter(p => p.type == 'cursus' and p.cursus)
        |map(p => p.cursus.id)
    %}

    <ul class="purchase-list">
        {% for purchase in purchases %}
            {% if purchase.type == 'lesson' and purchase.lesson %}
                {# Afficher la leÃ§on seulement si son cursus n'est pas dÃ©jÃ  achetÃ© #}
                {% if purchase.lesson.cursus.id not in purchasedCursusIds %}
                    <li>
                        <a href="{{ path('lesson_show', {id: purchase.lesson.id}) }}">
                            ğŸ“ LeÃ§on : {{ purchase.lesson.title }}
                        </a>
                    </li>
                {% endif %}
            {% elseif purchase.type == 'cursus' and purchase.cursus %}
                <li>
                    <a href="{{ path('cursus_show', {id: purchase.cursus.id}) }}">
                        ğŸ“˜ Cursus : {{ purchase.cursus.title }}
                    </a>
                </li>
            {% endif %}
        {% else %}
            <li>Vous nâ€™avez encore rien achetÃ©.</li>
        {% endfor %}
    </ul>
</section>
{% endblock %}
